{"version":3,"sources":["../../../src/components/VRating/VRating.tsx"],"names":["VBtn","makeDensityProps","makeSizeProps","makeTagProps","useProxiedModel","makeThemeProps","useTheme","useLocale","computed","ref","createRange","defineComponent","getUid","VRating","name","props","String","itemAriaLabel","type","default","activeColor","color","clearable","Boolean","disabled","emptyIcon","fullIcon","halfIncrements","hover","length","Number","readonly","modelValue","itemLabels","Array","itemLabelPosition","validator","v","includes","ripple","emits","value","setup","slots","t","themeClasses","rating","range","increments","flatMap","hoverIndex","focusIndex","firstRef","isClicking","itemState","map","isHovering","isFilled","isHovered","isFullIcon","icon","eventState","onMouseenter","onMouseleave","onFocus","focus","onBlur","onClick","undefined","onMousedown","onMouseup","VRatingItem","index","showStar","id","replace","btnProps","density","size","tag","variant","item","hasLabels","i","Math","ceil"],"mappings":";AAAA;AACA,uB,CAEA;;SACSA,I,6BAET;;SACSC,gB;SACAC,a;SACAC,Y;SACAC,e;SACAC,c,EAAgBC,Q;SAChBC,S,wCAET;;AACA,SAASC,QAAT,EAAmBC,GAAnB,QAA8B,KAA9B;SACSC,W,EAAaC,e,EAAiBC,M,gCAEvC;;AAIA,OAAO,MAAMC,OAAO,GAAGF,eAAe,CAAC;AACrCG,EAAAA,IAAI,EAAE,SAD+B;AAGrCC,EAAAA,KAAK,EAAE;AACLD,IAAAA,IAAI,EAAEE,MADD;AAELC,IAAAA,aAAa,EAAE;AACbC,MAAAA,IAAI,EAAEF,MADO;AAEbG,MAAAA,OAAO,EAAE;AAFI,KAFV;AAMLC,IAAAA,WAAW,EAAEJ,MANR;AAOLK,IAAAA,KAAK,EAAEL,MAPF;AAQLM,IAAAA,SAAS,EAAEC,OARN;AASLC,IAAAA,QAAQ,EAAED,OATL;AAULE,IAAAA,SAAS,EAAE;AACTP,MAAAA,IAAI,EAAEF,MADG;AAETG,MAAAA,OAAO,EAAE;AAFA,KAVN;AAcLO,IAAAA,QAAQ,EAAE;AACRR,MAAAA,IAAI,EAAEF,MADE;AAERG,MAAAA,OAAO,EAAE;AAFD,KAdL;AAkBLQ,IAAAA,cAAc,EAAEJ,OAlBX;AAmBLK,IAAAA,KAAK,EAAEL,OAnBF;AAoBLM,IAAAA,MAAM,EAAE;AACNX,MAAAA,IAAI,EAAE,CAACY,MAAD,EAASd,MAAT,CADA;AAENG,MAAAA,OAAO,EAAE;AAFH,KApBH;AAwBLY,IAAAA,QAAQ,EAAER,OAxBL;AAyBLS,IAAAA,UAAU,EAAE;AACVd,MAAAA,IAAI,EAAEY,MADI;AAEVX,MAAAA,OAAO,EAAE;AAFC,KAzBP;AA6BLc,IAAAA,UAAU,EAAEC,KA7BP;AA8BLC,IAAAA,iBAAiB,EAAE;AACjBjB,MAAAA,IAAI,EAAEF,MADW;AAEjBG,MAAAA,OAAO,EAAE,KAFQ;AAGjBiB,MAAAA,SAAS,EAAGC,CAAD,IAAY,CAAC,KAAD,EAAQ,QAAR,EAAkBC,QAAlB,CAA2BD,CAA3B;AAHN,KA9Bd;AAmCLE,IAAAA,MAAM,EAAEhB,OAnCH;AAqCL,OAAGtB,gBAAgB,EArCd;AAsCL,OAAGC,aAAa,EAtCX;AAuCL,OAAGC,YAAY,EAvCV;AAwCL,OAAGE,cAAc;AAxCZ,GAH8B;AA8CrCmC,EAAAA,KAAK,EAAE;AACL,yBAAsBC,KAAD,IAAmB;AADnC,GA9C8B;;AAkDrCC,EAAAA,KAAK,CAAE3B,KAAF,QAAoB;AAAA,QAAX;AAAE4B,MAAAA;AAAF,KAAW;AACvB,UAAM;AAAEC,MAAAA;AAAF,QAAQrC,SAAS,EAAvB;AACA,UAAM;AAAEsC,MAAAA;AAAF,QAAmBvC,QAAQ,CAACS,KAAD,CAAjC;AACA,UAAM+B,MAAM,GAAG1C,eAAe,CAACW,KAAD,EAAQ,YAAR,CAA9B;AAEA,UAAMgC,KAAK,GAAGvC,QAAQ,CAAC,MAAME,WAAW,CAACoB,MAAM,CAACf,KAAK,CAACc,MAAP,CAAP,EAAuB,CAAvB,CAAlB,CAAtB;AACA,UAAMmB,UAAU,GAAGxC,QAAQ,CAAC,MAAMuC,KAAK,CAACN,KAAN,CAAYQ,OAAZ,CAAoBZ,CAAC,IAAItB,KAAK,CAACY,cAAN,GAAuB,CAACU,CAAC,GAAG,GAAL,EAAUA,CAAV,CAAvB,GAAsC,CAACA,CAAD,CAA/D,CAAP,CAA3B;AACA,UAAMa,UAAU,GAAGzC,GAAG,CAAC,CAAC,CAAF,CAAtB;AACA,UAAM0C,UAAU,GAAG1C,GAAG,CAAC,CAAC,CAAF,CAAtB;AACA,UAAM2C,QAAQ,GAAG3C,GAAG,EAApB;AACA,QAAI4C,UAAU,GAAG,KAAjB;AAEA,UAAMC,SAAS,GAAG9C,QAAQ,CAAC,MAAMwC,UAAU,CAACP,KAAX,CAAiBc,GAAjB,CAAqBd,KAAK,IAAI;AAAA;;AAC7D,YAAMe,UAAU,GAAGzC,KAAK,CAACa,KAAN,IAAesB,UAAU,CAACT,KAAX,GAAmB,CAAC,CAAtD;AACA,YAAMgB,QAAQ,GAAGX,MAAM,CAACL,KAAP,IAAgBA,KAAjC;AACA,YAAMiB,SAAS,GAAGR,UAAU,CAACT,KAAX,IAAoBA,KAAtC;AACA,YAAMkB,UAAU,GAAGH,UAAU,GAAGE,SAAH,GAAeD,QAA5C;AACA,YAAMG,IAAI,GAAGD,UAAU,GAAG5C,KAAK,CAACW,QAAT,GAAoBX,KAAK,CAACU,SAAjD;AACA,YAAML,WAAW,yBAAGL,KAAK,CAACK,WAAT,iCAAwBL,KAAK,CAACM,KAA/C;AACA,YAAMA,KAAK,GAAIoC,QAAQ,IAAIC,SAAb,GAA0BtC,WAA1B,GAAwCL,KAAK,CAACM,KAA5D;AAEA,aAAO;AAAEoC,QAAAA,QAAF;AAAYC,QAAAA,SAAZ;AAAuBE,QAAAA,IAAvB;AAA6BvC,QAAAA;AAA7B,OAAP;AACD,KAVgC,CAAP,CAA1B;AAYA,UAAMwC,UAAU,GAAGrD,QAAQ,CAAC,MAAM,CAAC,CAAD,EAAI,GAAGwC,UAAU,CAACP,KAAlB,EAAyBc,GAAzB,CAA6Bd,KAAK,IAAI;AACtE,eAASqB,YAAT,GAAyB;AACvBZ,QAAAA,UAAU,CAACT,KAAX,GAAmBA,KAAnB;AACD;;AAED,eAASsB,YAAT,GAAyB;AACvBb,QAAAA,UAAU,CAACT,KAAX,GAAmB,CAAC,CAApB;AACD;;AAED,eAASuB,OAAT,GAAoB;AAClB,YAAIvB,KAAK,KAAK,CAAV,IAAeK,MAAM,CAACL,KAAP,KAAiB,CAApC,EAAuC;AAAA;;AACrC,6BAAAW,QAAQ,CAACX,KAAT,qCAAgBwB,KAAhB;AACD,SAFD,MAEO;AACLd,UAAAA,UAAU,CAACV,KAAX,GAAmBA,KAAnB;AACD;AACF;;AAED,eAASyB,MAAT,GAAmB;AACjB,YAAI,CAACb,UAAL,EAAiBF,UAAU,CAACV,KAAX,GAAmB,CAAC,CAApB;AAClB;;AAED,eAAS0B,OAAT,GAAoB;AAClB,YAAIpD,KAAK,CAACS,QAAN,IAAkBT,KAAK,CAACgB,QAA5B,EAAsC;AACtCe,QAAAA,MAAM,CAACL,KAAP,GAAeK,MAAM,CAACL,KAAP,KAAiBA,KAAjB,IAA0B1B,KAAK,CAACO,SAAhC,GAA4C,CAA5C,GAAgDmB,KAA/D;AACD;;AAED,aAAO;AACLqB,QAAAA,YAAY,EAAE/C,KAAK,CAACa,KAAN,GAAckC,YAAd,GAA6BM,SADtC;AAELL,QAAAA,YAAY,EAAEhD,KAAK,CAACa,KAAN,GAAcmC,YAAd,GAA6BK,SAFtC;AAGLJ,QAAAA,OAHK;AAILE,QAAAA,MAJK;AAKLC,QAAAA;AALK,OAAP;AAOD,KAjCiC,CAAP,CAA3B;;AAmCA,aAASE,WAAT,GAAwB;AACtBhB,MAAAA,UAAU,GAAG,IAAb;AACD;;AAED,aAASiB,SAAT,GAAsB;AACpBjB,MAAAA,UAAU,GAAG,KAAb;AACD;;AAED,UAAMvC,IAAI,GAAGN,QAAQ,CAAC;AAAA;;AAAA,4BAAMO,KAAK,CAACD,IAAZ,0BAAqB,YAAWF,MAAM,EAAG,EAAzC;AAAA,KAAD,CAArB;;AAEA,aAAS2D,WAAT,QAA+G;AAAA;;AAAA,UAAzF;AAAE9B,QAAAA,KAAF;AAAS+B,QAAAA,KAAT;AAAgBC,QAAAA,QAAQ,GAAG;AAA3B,OAAyF;AAC7G,YAAM;AAAEX,QAAAA,YAAF;AAAgBC,QAAAA,YAAhB;AAA8BC,QAAAA,OAA9B;AAAuCE,QAAAA,MAAvC;AAA+CC,QAAAA;AAA/C,UAA2DN,UAAU,CAACpB,KAAX,CAAiB+B,KAAK,GAAG,CAAzB,CAAjE;AACA,YAAME,EAAE,GAAI,GAAE5D,IAAI,CAAC2B,KAAM,IAAGzB,MAAM,CAACyB,KAAD,CAAN,CAAckC,OAAd,CAAsB,GAAtB,EAA2B,GAA3B,CAAgC,EAA5D;AACA,YAAMC,QAAQ,GAAG;AACfvD,QAAAA,KAAK,2BAAEiC,SAAS,CAACb,KAAV,CAAgB+B,KAAhB,CAAF,qBAAE,sBAAwBnD,KADhB;AAEfwD,QAAAA,OAAO,EAAE9D,KAAK,CAAC8D,OAFA;AAGfrD,QAAAA,QAAQ,EAAET,KAAK,CAACS,QAHD;AAIfoC,QAAAA,IAAI,4BAAEN,SAAS,CAACb,KAAV,CAAgB+B,KAAhB,CAAF,qBAAE,uBAAwBZ,IAJf;AAKfrB,QAAAA,MAAM,EAAExB,KAAK,CAACwB,MALC;AAMfuC,QAAAA,IAAI,EAAE/D,KAAK,CAAC+D,IANG;AAOfC,QAAAA,GAAG,EAAE,MAPU;AAQfC,QAAAA,OAAO,EAAE;AARM,OAAjB;AAWA;AAAA,eAGYN,EAHZ;AAAA,iBAIa;AACL,kCAAwB3D,KAAK,CAACY,cAAN,IAAwBc,KAAK,GAAG,CAAR,GAAY,CADvD;AAEL,kCAAwB1B,KAAK,CAACY,cAAN,IAAwBc,KAAK,GAAG,CAAR,KAAc;AAFzD,SAJb;AAAA,uBAQoB4B,WARpB;AAAA,qBASkBC,SATlB;AAAA,wBAUqBR,YAVrB;AAAA,wBAWqBC;AAXrB;AAAA,iBAakB;AAblB,UAauCnB,CAAC,CAAC7B,KAAK,CAACE,aAAP,EAAsBwB,KAAtB,EAA6B1B,KAAK,CAACc,MAAnC,CAbxC,IAeQ,CAAC4C,QAAD,GAAYL,SAAZ,GACEzB,KAAK,CAACsC,IAAN,GAAatC,KAAK,CAACsC,IAAN,CAAW,EACxB,GAAG3B,SAAS,CAACb,KADW;AAExB1B,QAAAA,KAAK,EAAE6D,QAFiB;AAGxBnC,QAAAA,KAHwB;AAIxB+B,QAAAA;AAJwB,OAAX,CAAb,sBAOWI,QAPX,WAhBV;AAAA,iBA4BY,kBA5BZ;AAAA,gBA6Ba9D,IAAI,CAAC2B,KA7BlB;AAAA,cA8BWiC,EA9BX;AAAA,gBA+BW,OA/BX;AAAA,iBAgCcjC,KAhCd;AAAA,mBAiCgBK,MAAM,CAACL,KAAP,KAAiBA,KAjCjC;AAAA,mBAkCgB0B,OAlChB;AAAA,mBAmCgBH,OAnChB;AAAA,kBAoCeE,MApCf;AAAA,eAqCYM,KAAK,KAAK,CAAV,GAAcpB,QAAd,GAAyBgB,SArCrC;AAAA,oBAsCiBrD,KAAK,CAACgB,QAtCvB;AAAA,oBAuCiBhB,KAAK,CAACS;AAvCvB;AA2CD;;AAED,WAAO,MAAM;AAAA;;AACX,YAAM0D,SAAS,GAAG,CAAC,uBAACnE,KAAK,CAACkB,UAAP,aAAC,kBAAkBJ,MAAnB,CAAnB;AAEA;AAAA,iBAEW,CACL,UADK,EAEL;AACE,6BAAmBd,KAAK,CAACa,KAD3B;AAEE,gCAAsBb,KAAK,CAACgB;AAF9B,SAFK,EAMLc,YAAY,CAACJ,KANR;AAFX;AAAA;AAAA,mBAWyB,CAXzB;AAAA,mBAWqC,CAAC,CAXtC;AAAA,sBAWqD;AAXrD,gCAaMM,KAAK,CAACN,KAAN,CAAYc,GAAZ,CAAgB,CAACd,KAAD,EAAQ0C,CAAR;AAAA;;AAAA;AAAA,qBACL;AADK,cAGZ,CAACD,SAAD,GAAad,SAAb,GACEzB,KAAK,CAAC,YAAD,CAAL,GAAsBA,KAAK,CAAC,YAAD,CAAL,EAAtB,GACA,sBAAA5B,KAAK,CAACkB,UAAN,gCAAmBkD,CAAnB,sDAAgCpE,KAAK,CAACkB,UAAtC,qBAAgC,mBAAmBkD,CAAnB,CAAhC,2DALU;AAAA,qBASL,CACL,gBADK,EAEL;AACE,yCAA2BC,IAAI,CAACC,IAAL,CAAUlC,UAAU,CAACV,KAArB,MAAgCA;AAD7D,aAFK;AATK,cAgBV1B,KAAK,CAACY,cAAN;AAAA,qBAEuBc,KAAK,GAAG,GAF/B;AAAA,qBAE6C0C,CAAC,GAAG;AAFjD;AAAA,qBAGuB1C,KAHvB;AAAA,qBAGwC0C,CAAC,GAAG,CAAL,GAAU;AAHjD;AAAA,qBAMqB1C,KANrB;AAAA,qBAMqC0C;AANrC,yCAhBU;AAAA,SAAhB,CAbN;AAAA;AAAA;AA0CD,KA7CD;AA8CD;;AAhOoC,CAAD,CAA/B","sourcesContent":["// Styles\nimport './VRating.sass'\n\n// Components\nimport { VBtn } from '../VBtn'\n\n// Composables\nimport { makeDensityProps } from '@/composables/density'\nimport { makeSizeProps } from '@/composables/size'\nimport { makeTagProps } from '@/composables/tag'\nimport { useProxiedModel } from '@/composables/proxiedModel'\nimport { makeThemeProps, useTheme } from '@/composables/theme'\nimport { useLocale } from '@/composables/locale'\n\n// Utilities\nimport { computed, ref } from 'vue'\nimport { createRange, defineComponent, getUid } from '@/util'\n\n// Types\nimport type { Variant } from '@/composables/variant'\nimport type { Prop } from 'vue'\n\nexport const VRating = defineComponent({\n  name: 'VRating',\n\n  props: {\n    name: String,\n    itemAriaLabel: {\n      type: String,\n      default: '$vuetify.rating.ariaLabel.item',\n    },\n    activeColor: String,\n    color: String,\n    clearable: Boolean,\n    disabled: Boolean,\n    emptyIcon: {\n      type: String,\n      default: '$ratingEmpty',\n    },\n    fullIcon: {\n      type: String,\n      default: '$ratingFull',\n    },\n    halfIncrements: Boolean,\n    hover: Boolean,\n    length: {\n      type: [Number, String],\n      default: 5,\n    },\n    readonly: Boolean,\n    modelValue: {\n      type: Number,\n      default: 0,\n    },\n    itemLabels: Array as Prop<string[]>,\n    itemLabelPosition: {\n      type: String,\n      default: 'top',\n      validator: (v: any) => ['top', 'bottom'].includes(v),\n    },\n    ripple: Boolean,\n\n    ...makeDensityProps(),\n    ...makeSizeProps(),\n    ...makeTagProps(),\n    ...makeThemeProps(),\n  },\n\n  emits: {\n    'update:modelValue': (value: number) => true,\n  },\n\n  setup (props, { slots }) {\n    const { t } = useLocale()\n    const { themeClasses } = useTheme(props)\n    const rating = useProxiedModel(props, 'modelValue')\n\n    const range = computed(() => createRange(Number(props.length), 1))\n    const increments = computed(() => range.value.flatMap(v => props.halfIncrements ? [v - 0.5, v] : [v]))\n    const hoverIndex = ref(-1)\n    const focusIndex = ref(-1)\n    const firstRef = ref<HTMLElement>()\n    let isClicking = false\n\n    const itemState = computed(() => increments.value.map(value => {\n      const isHovering = props.hover && hoverIndex.value > -1\n      const isFilled = rating.value >= value\n      const isHovered = hoverIndex.value >= value\n      const isFullIcon = isHovering ? isHovered : isFilled\n      const icon = isFullIcon ? props.fullIcon : props.emptyIcon\n      const activeColor = props.activeColor ?? props.color\n      const color = (isFilled || isHovered) ? activeColor : props.color\n\n      return { isFilled, isHovered, icon, color }\n    }))\n\n    const eventState = computed(() => [0, ...increments.value].map(value => {\n      function onMouseenter () {\n        hoverIndex.value = value\n      }\n\n      function onMouseleave () {\n        hoverIndex.value = -1\n      }\n\n      function onFocus () {\n        if (value === 0 && rating.value === 0) {\n          firstRef.value?.focus()\n        } else {\n          focusIndex.value = value\n        }\n      }\n\n      function onBlur () {\n        if (!isClicking) focusIndex.value = -1\n      }\n\n      function onClick () {\n        if (props.disabled || props.readonly) return\n        rating.value = rating.value === value && props.clearable ? 0 : value\n      }\n\n      return {\n        onMouseenter: props.hover ? onMouseenter : undefined,\n        onMouseleave: props.hover ? onMouseleave : undefined,\n        onFocus,\n        onBlur,\n        onClick,\n      }\n    }))\n\n    function onMousedown () {\n      isClicking = true\n    }\n\n    function onMouseup () {\n      isClicking = false\n    }\n\n    const name = computed(() => props.name ?? `v-rating-${getUid()}`)\n\n    function VRatingItem ({ value, index, showStar = true }: { value: number, index: number, showStar?: boolean }) {\n      const { onMouseenter, onMouseleave, onFocus, onBlur, onClick } = eventState.value[index + 1]\n      const id = `${name.value}-${String(value).replace('.', '-')}`\n      const btnProps = {\n        color: itemState.value[index]?.color,\n        density: props.density,\n        disabled: props.disabled,\n        icon: itemState.value[index]?.icon,\n        ripple: props.ripple,\n        size: props.size,\n        tag: 'span',\n        variant: 'plain' as Variant,\n      }\n\n      return (\n        <>\n          <label\n            for={ id }\n            class={{\n              'v-rating__item--half': props.halfIncrements && value % 1 > 0,\n              'v-rating__item--full': props.halfIncrements && value % 1 === 0,\n            }}\n            onMousedown={ onMousedown }\n            onMouseup={ onMouseup }\n            onMouseenter={ onMouseenter }\n            onMouseleave={ onMouseleave }\n          >\n            <span class=\"v-rating__hidden\">{ t(props.itemAriaLabel, value, props.length) }</span>\n            {\n              !showStar ? undefined\n              : slots.item ? slots.item({\n                ...itemState.value,\n                props: btnProps,\n                value,\n                index,\n              })\n              : (\n                <VBtn { ...btnProps } />\n              )\n            }\n          </label>\n          <input\n            class=\"v-rating__hidden\"\n            name={ name.value }\n            id={ id }\n            type=\"radio\"\n            value={ value }\n            checked={ rating.value === value }\n            onClick={ onClick }\n            onFocus={ onFocus }\n            onBlur={ onBlur }\n            ref={ index === 0 ? firstRef : undefined }\n            readonly={ props.readonly }\n            disabled={ props.disabled }\n          />\n        </>\n      )\n    }\n\n    return () => {\n      const hasLabels = !!props.itemLabels?.length\n\n      return (\n        <props.tag\n          class={[\n            'v-rating',\n            {\n              'v-rating--hover': props.hover,\n              'v-rating--readonly': props.readonly,\n            },\n            themeClasses.value,\n          ]}\n        >\n          <VRatingItem value={ 0 } index={ -1 } showStar={ false } />\n\n          { range.value.map((value, i) => (\n            <div class=\"v-rating__wrapper\">\n              {\n                !hasLabels ? undefined\n                : slots['item-label'] ? slots['item-label']()\n                : props.itemLabels?.[i] ? <span>{ props.itemLabels?.[i] }</span>\n                : <span>&nbsp;</span>\n              }\n              <div\n                class={[\n                  'v-rating__item',\n                  {\n                    'v-rating__item--focused': Math.ceil(focusIndex.value) === value,\n                  },\n                ]}\n              >\n                { props.halfIncrements ? (\n                  <>\n                    <VRatingItem value={ value - 0.5 } index={ i * 2 } />\n                    <VRatingItem value={ value } index={ (i * 2) + 1 } />\n                  </>\n                ) : (\n                  <VRatingItem value={ value } index={ i } />\n                ) }\n              </div>\n            </div>\n          )) }\n        </props.tag>\n      )\n    }\n  },\n})\n\nexport type VRating = InstanceType<typeof VRating>\n"],"file":"VRating.mjs"}