{"version":3,"sources":["../../src/util/animation.ts"],"names":["Box","nullifyTransforms","el","rect","getBoundingClientRect","style","getComputedStyle","tx","transform","ta","sx","sy","dx","dy","startsWith","slice","split","to","transformOrigin","x","parseFloat","y","indexOf","w","width","offsetWidth","h","height","offsetHeight"],"mappings":"SAASA,G;AAET;;AACA,OAAO,SAASC,iBAAT,CAA4BC,EAA5B,EAAkD;AACvD,QAAMC,IAAI,GAAGD,EAAE,CAACE,qBAAH,EAAb;AACA,QAAMC,KAAK,GAAGC,gBAAgB,CAACJ,EAAD,CAA9B;AACA,QAAMK,EAAE,GAAGF,KAAK,CAACG,SAAjB;;AAEA,MAAID,EAAJ,EAAQ;AACN,QAAIE,EAAJ,EAAQC,EAAR,EAAYC,EAAZ,EAAgBC,EAAhB,EAAoBC,EAApB;;AACA,QAAIN,EAAE,CAACO,UAAH,CAAc,WAAd,CAAJ,EAAgC;AAC9BL,MAAAA,EAAE,GAAGF,EAAE,CAACQ,KAAH,CAAS,CAAT,EAAY,CAAC,CAAb,EAAgBC,KAAhB,CAAsB,IAAtB,CAAL;AACAN,MAAAA,EAAE,GAAG,CAACD,EAAE,CAAC,CAAD,CAAR;AACAE,MAAAA,EAAE,GAAG,CAACF,EAAE,CAAC,CAAD,CAAR;AACAG,MAAAA,EAAE,GAAG,CAACH,EAAE,CAAC,EAAD,CAAR;AACAI,MAAAA,EAAE,GAAG,CAACJ,EAAE,CAAC,EAAD,CAAR;AACD,KAND,MAMO,IAAIF,EAAE,CAACO,UAAH,CAAc,SAAd,CAAJ,EAA8B;AACnCL,MAAAA,EAAE,GAAGF,EAAE,CAACQ,KAAH,CAAS,CAAT,EAAY,CAAC,CAAb,EAAgBC,KAAhB,CAAsB,IAAtB,CAAL;AACAN,MAAAA,EAAE,GAAG,CAACD,EAAE,CAAC,CAAD,CAAR;AACAE,MAAAA,EAAE,GAAG,CAACF,EAAE,CAAC,CAAD,CAAR;AACAG,MAAAA,EAAE,GAAG,CAACH,EAAE,CAAC,CAAD,CAAR;AACAI,MAAAA,EAAE,GAAG,CAACJ,EAAE,CAAC,CAAD,CAAR;AACD,KANM,MAMA;AACL,aAAO,IAAIT,GAAJ,CAAQG,IAAR,CAAP;AACD;;AAED,UAAMc,EAAE,GAAGZ,KAAK,CAACa,eAAjB;AACA,UAAMC,CAAC,GAAGhB,IAAI,CAACgB,CAAL,GAASP,EAAT,GAAc,CAAC,IAAIF,EAAL,IAAWU,UAAU,CAACH,EAAD,CAA7C;AACA,UAAMI,CAAC,GAAGlB,IAAI,CAACkB,CAAL,GAASR,EAAT,GAAc,CAAC,IAAIF,EAAL,IAAWS,UAAU,CAACH,EAAE,CAACF,KAAH,CAASE,EAAE,CAACK,OAAH,CAAW,GAAX,IAAkB,CAA3B,CAAD,CAA7C;AACA,UAAMC,CAAC,GAAGb,EAAE,GAAGP,IAAI,CAACqB,KAAL,GAAad,EAAhB,GAAqBR,EAAE,CAACuB,WAApC;AACA,UAAMC,CAAC,GAAGf,EAAE,GAAGR,IAAI,CAACwB,MAAL,GAAchB,EAAjB,GAAsBT,EAAE,CAAC0B,YAArC;AAEA,WAAO,IAAI5B,GAAJ,CAAQ;AAAEmB,MAAAA,CAAF;AAAKE,MAAAA,CAAL;AAAQG,MAAAA,KAAK,EAAED,CAAf;AAAkBI,MAAAA,MAAM,EAAED;AAA1B,KAAR,CAAP;AACD,GAzBD,MAyBO;AACL,WAAO,IAAI1B,GAAJ,CAAQG,IAAR,CAAP;AACD;AACF","sourcesContent":["import { Box } from '@/util/box'\n\n/** @see https://stackoverflow.com/a/57876601/2074736 */\nexport function nullifyTransforms (el: HTMLElement): Box {\n  const rect = el.getBoundingClientRect()\n  const style = getComputedStyle(el)\n  const tx = style.transform\n\n  if (tx) {\n    let ta, sx, sy, dx, dy\n    if (tx.startsWith('matrix3d(')) {\n      ta = tx.slice(9, -1).split(/, /)\n      sx = +ta[0]\n      sy = +ta[5]\n      dx = +ta[12]\n      dy = +ta[13]\n    } else if (tx.startsWith('matrix(')) {\n      ta = tx.slice(7, -1).split(/, /)\n      sx = +ta[0]\n      sy = +ta[3]\n      dx = +ta[4]\n      dy = +ta[5]\n    } else {\n      return new Box(rect)\n    }\n\n    const to = style.transformOrigin\n    const x = rect.x - dx - (1 - sx) * parseFloat(to)\n    const y = rect.y - dy - (1 - sy) * parseFloat(to.slice(to.indexOf(' ') + 1))\n    const w = sx ? rect.width / sx : el.offsetWidth\n    const h = sy ? rect.height / sy : el.offsetHeight\n\n    return new Box({ x, y, width: w, height: h })\n  } else {\n    return new Box(rect)\n  }\n}\n"],"file":"animation.mjs"}